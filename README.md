# TON Dice Bank

–û—Ñ—Ñ—á–µ–π–Ω-–±–∞–Ω–∫ –¥–ª—è Dice-–∏–≥—Ä—ã —Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π Telegram WebApp –∏ TON –∫–æ—à–µ–ª—å–∫–æ–≤.

## üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π –¥–µ—Ç–µ–∫—Ç Telegram WebApp
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å TonConnect –¥–ª—è TON –∫–æ—à–µ–ª—å–∫–æ–≤
- ‚úÖ –û—Ñ—Ñ—á–µ–π–Ω-–±–∞–Ω–∫ —Å –¥–µ–ø–æ–∑–∏—Ç–∞–º–∏ –∏ –≤—ã–≤–æ–¥–∞–º–∏
- ‚úÖ –ü—Ä–æ–≤–µ—Ä—è–µ–º–∞—è —á–µ—Å—Ç–Ω–æ—Å—Ç—å –∏–≥—Ä—ã
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø—É–ª–ª–µ—Ä –¥–µ–ø–æ–∑–∏—Ç–æ–≤
- ‚úÖ Supabase PostgreSQL –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

## üõ† –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- **Frontend**: Vite + React + TypeScript
- **Backend**: Node.js + Express + Prisma
- **Database**: Supabase PostgreSQL
- **Blockchain**: TON + TonConnect
- **Telegram**: WebApp API

## üìã –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### 1. –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª—ã `.env` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ –∏ `web/.env.local`:

```bash
# .env (backend)
TREASURY_ADDRESS=<EQ... –≤–∞—à –∞–¥—Ä–µ—Å –∫–∞–∑–Ω—ã>
WITHDRAW_PRIVATE_KEY=<seed/private key –∫–æ—à–µ–ª—å–∫–∞ –¥–ª—è –≤—ã–≤–æ–¥–∞>
VITE_TG_BOT_USERNAME=<–∏–º—è –±–æ—Ç–∞ –±–µ–∑ @>

# Supabase / Postgres
DATABASE_URL=postgresql://postgres:Batlvol5690@fssuowsdqtolbdjkyxvu.supabase.co:5432/postgres

# tonapi
TON_API_KEY=AE2AXH33J4FXT7AAAAAAQKOWZ46XVTOZQAUJ764DWTDAQ2ZLSQMVBDLVCLXUFIFROV7HVUA

# —Ñ—Ä–æ–Ω—Ç
VITE_PUBLIC_WEBAPP_URL=https://<–≤–∞—à_–¥–æ–º–µ–Ω_–º–∏–Ω–∏_–∞–ø–ø—ã>
```

```bash
# web/.env.local (frontend)
VITE_TG_BOT_USERNAME=<–∏–º—è –±–æ—Ç–∞ –±–µ–∑ @>
VITE_PUBLIC_WEBAPP_URL=https://<–≤–∞—à_–¥–æ–º–µ–Ω_–º–∏–Ω–∏_–∞–ø–ø—ã>
```

### 2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
# Backend
npm install

# Frontend
npm run web:install
```

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

```bash
# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è Prisma –∫–ª–∏–µ–Ω—Ç–∞
npm run db:generate

# –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Å—Ö–µ–º—ã –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
npm run db:push
```

### 4. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–∞–Ω–∏—Ñ–µ—Å—Ç–∞ TonConnect

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `web/public/tonconnect-manifest.json`:

```json
{
  "url": "https://<–≤–∞—à_–¥–æ–º–µ–Ω_–º–∏–Ω–∏_–∞–ø–ø—ã>",
  "name": "Dice Bank",
  "iconUrl": "https://<–≤–∞—à_–¥–æ–º–µ–Ω_–º–∏–Ω–∏_–∞–ø–ø—ã>/icon.png"
}
```

## üöÄ –ó–∞–ø—É—Å–∫

### –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

```bash
# Backend API (—Ç–µ—Ä–º–∏–Ω–∞–ª 1)
npm run dev:api

# –ü—É–ª–ª–µ—Ä –¥–µ–ø–æ–∑–∏—Ç–æ–≤ (—Ç–µ—Ä–º–∏–Ω–∞–ª 2)
npm run dev:puller

# Frontend (—Ç–µ—Ä–º–∏–Ω–∞–ª 3)
npm run web:dev
```

### –ü—Ä–æ–¥–∞–∫—à–Ω

```bash
# –°–±–æ—Ä–∫–∞
npm run build
npm run web:build

# –ó–∞–ø—É—Å–∫
npm run start:api
npm run start:puller
```

## üì± –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

1. **Telegram Bot**: –°–æ–∑–¥–∞–π—Ç–µ –±–æ—Ç–∞ —á–µ—Ä–µ–∑ @BotFather
2. **WebApp URL**: –£–∫–∞–∂–∏—Ç–µ URL –≤–∞—à–µ–≥–æ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –±–æ—Ç–∞
3. **–î–µ–ø–ª–æ–π**: –†–∞–∑–≤–µ—Ä–Ω–∏—Ç–µ –Ω–∞ Vercel/Netlify
4. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**: –û—Ç–∫—Ä–æ–π—Ç–µ –±–æ—Ç–∞ –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ Mini App

## üîß API Endpoints

- `GET /api/health` - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è
- `GET /api/balance?tg_id=...` - –ü–æ–ª—É—á–∏—Ç—å –±–∞–ª–∞–Ω—Å
- `GET /api/ledger?tg_id=...` - –ò—Å—Ç–æ—Ä–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
- `POST /api/bet` - –°–¥–µ–ª–∞—Ç—å —Å—Ç–∞–≤–∫—É
- `POST /api/withdraw` - –í—ã–≤–æ–¥ —Å—Ä–µ–¥—Å—Ç–≤
- `POST /api/deposit` - –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–µ–ø–æ–∑–∏—Ç–æ–≤ (–≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π)

## üé≤ –ò–≥—Ä–æ–≤–∞—è –º–µ—Ö–∞–Ω–∏–∫–∞

- **Target**: 1-99 (–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –≤—ã–∏–≥—Ä—ã—à–∞)
- **–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç**: `(100 / target) * 0.98` (2% –∫–æ–º–∏—Å—Å–∏—è)
- **–£—Å–ª–æ–≤–∏–µ –≤—ã–∏–≥—Ä—ã—à–∞**: `roll < target`
- **RNG**: `crypto.randomInt(0, 100)`

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- –í–∞–ª–∏–¥–∞—Ü–∏—è Telegram ID —á–µ—Ä–µ–∑ –∑–∞–≥–æ–ª–æ–≤–∫–∏
- –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å—Ç–∞–≤–æ–∫
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
- –õ–∏–º–∏—Ç—ã –Ω–∞ –≤—ã–≤–æ–¥—ã

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

–ü—É–ª–ª–µ—Ä –¥–µ–ø–æ–∑–∏—Ç–æ–≤ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –∫–∞–∂–¥—ã–µ 10 —Å–µ–∫—É–Ω–¥:
- –§–∏–ª—å—Ç—Ä—É–µ—Ç –≤—Ö–æ–¥—è—â–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Ñ–æ—Ä–º–∞—Ç memo: `GAME:tg_id:nonce`
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞—á–∏—Å–ª—è–µ—Ç –¥–µ–ø–æ–∑–∏—Ç—ã

## üêõ –û—Ç–ª–∞–¥–∫–∞

```bash
# –õ–æ–≥–∏ API
npm run dev:api

# –õ–æ–≥–∏ –ø—É–ª–ª–µ—Ä–∞
npm run dev:puller

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
npx prisma studio
```

## üìù –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License


